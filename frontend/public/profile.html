<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apock Web Design</title>
    <link rel="stylesheet" type="text/css" href="https://necolas.github.io/normalize.css/8.0.1/normalize.css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="../src/styles/profle.css">
</head>

<body>

    <section class="seccion-perfil-usuario">
        <div class="perfil-usuario-header">
            <button class="boton-volver" onclick="window.history.back();"><i class="fas fa-arrow-left"></i></button>
            <div class="perfil-usuario-portada" id="cover-photo" style="background-image: url('');">
                <div class="perfil-usuario-avatar">
                    <img id="profile-pic" src="http://localhost/multimedia/relleno/img-c9.png" alt="img-avatar">
                    <input type="file" id="file-input-avatar" accept="image/*" style="display: none;">
                    <button type="button" class="boton-avatar" onclick="document.getElementById('file-input-avatar').click();">
                        <i class="far fa-image"></i>
                    </button>
                </div>
                <button type="button" class="boton-portada" onclick="document.getElementById('file-input-cover').click();">
                    <i class="far fa-image"></i>
                </button>
                <input type="file" id="file-input-cover" accept="image/*" style="display: none;">
            </div>
        </div>

        <div class="perfil-usuario-body">
            <div class="perfil-usuario-bio">
                <h3 class="titulo" id="username"></h3>
                <div class="container-description">
                    <p class="texto" id="user-description"></p>
                </div>
                <div class="perfil-usuario-datos">
                    <ul class="lista-datos">
                        <li><i class="icono fas fa-user"></i> Nombre: Juan Pérez</li>
                        <li><i class="icono fas fa-info-circle"></i> Descripción: Desarrollador web con 5 años de experiencia</li>
                        <li><i class="icono fas fa-phone-alt"></i> Teléfono: 555-5555</li>
                        <li><i class="icono fas fa-envelope"></i> Correo: contacto@apockweb.com</li>
                    </ul>
                </div>
                <button class="boton-editar" onclick="toggleEditForm()">
                    <i class="fas fa-pencil-alt"></i> 
                </button>
            </div>

        <div id="edit-form-container" class="hidden">
            <h3>Editar Información</h3>
            <form action="/submit" method="POST">
                <label for="nombre">Nombre:</label><br>
                <input type="text" id="nombre" name="nombre" required><br><br>

                <label for="descripcion">Descripción:</label><br>
                <textarea id="descripcion" name="descripcion" rows="4" cols="50" required></textarea><br><br>

                <label for="telefono">Teléfono:</label><br>
                <input type="tel" id="telefono" name="telefono" required><br><br>

                <label for="email">Correo Electrónico:</label><br>
                <input type="email" id="email" name="email" required><br><br>

                <button class="buttom-save-changes" type="button" onclick="updateProfile()">Guardar</button>
            </form>
        </div>


    </section>

    <script>
        
        // Variables para los elementos de la imagen de perfil y portada
        const fileInputAvatar = document.getElementById('file-input-avatar');
        const fileInputCover = document.getElementById('file-input-cover');
        const profilePic = document.getElementById('profile-pic');
        const coverPhoto = document.getElementById('cover-photo');

        // Cargar las imágenes y datos guardados en localStorage al cargar la página
        window.addEventListener('load', () => {
            const savedImage = localStorage.getItem('profileImage');
            if (savedImage) {
                profilePic.src = savedImage; // Establece la imagen de perfil
            }

            const savedCoverImage = localStorage.getItem('coverImage');
            if (savedCoverImage) {
                coverPhoto.style.backgroundImage = `url('${savedCoverImage}')`; // Establece la imagen de portada
            }

            const savedUsername = localStorage.getItem('username');
            if (savedUsername) {
                usernameElement.innerText= savedUsername; // Establece el nombre de usuario
            }

            const savedDescription = localStorage.getItem('userDescription');
            if (savedDescription) {
                descriptionElement.innerText = savedDescription; // Establece la descripción del usuario
            }
        });

        // Cambia la imagen de perfil cuando se selecciona un archivo
        fileInputAvatar.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    profilePic.src = e.target.result; // Muestra la nueva imagen de perfil
                    localStorage.setItem('profileImage', e.target.result); // Guarda la imagen en localStorage
                };
                reader.readAsDataURL(file);
            }
        });

        // Cambia la imagen de portada cuando se selecciona un archivo
        fileInputCover.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    coverPhoto.style.backgroundImage = `url('${e.target.result}')`; // Muestra la nueva imagen de portada
                    localStorage.setItem('coverImage', e.target.result); // Guarda la imagen en localStorage
                };
                reader.readAsDataURL(file);
            }
        });

        // Muestra u oculta el formulario de edición
        function toggleEditForm() {
            const formContainer = document.getElementById('edit-form-container');
            formContainer.classList.toggle('hidden'); // Alterna la visibilidad del formulario

            // Precargar los datos actuales en el formulario de edición
            document.getElementById('nombre').value = document.getElementById('username').textContent;
            document.getElementById('descripcion').value = document.getElementById('user-description').textContent;
            document.getElementById('telefono').value = document.getElementById('user-phone').textContent;
            document.getElementById('email').value = document.getElementById('user-email').textContent;
        }

        // Actualiza el perfil con los valores ingresados en el formulario
        function updateProfile() {
            // Obtener los valores del formulario
            const nombre = document.getElementById('nombre').value;
            const descripcion = document.getElementById('descripcion').value;
            const telefono = document.getElementById('telefono').value;
            const email = document.getElementById('email').value;

            // Actualizar el contenido del perfil en la página
            document.getElementById('username').textContent = nombre;
            document.getElementById('user-description').textContent = descripcion;
            document.getElementById('user-phone').textContent = telefono;
            document.getElementById('user-email').textContent = email;

            // Ocultar el formulario después de guardar los cambios
            toggleEditForm();
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>

</body>

</html>
